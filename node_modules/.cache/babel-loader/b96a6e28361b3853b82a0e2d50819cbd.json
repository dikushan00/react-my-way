{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport { ProfileAPI } from \"../api/api\";\nimport { stopSubmit } from \"redux-form\";\nvar ADD_NEW_POST = \"ADD-NEW-POST\";\nvar PROFILE_INFO = \"PROFILE_INFO\";\nvar SET_STATUS = \"SET_STATUS\";\nvar SET_PHOTO = \"SET_PHOTO\";\nvar initialState = {\n  postsData: [{\n    \"id\": 1,\n    \"message\": \"Hello, how are you?\",\n    \"likesCount\": 5\n  }, {\n    \"id\": 2,\n    \"message\": \"My, first post!\",\n    \"likesCount\": 2\n  }, {\n    \"id\": 3,\n    \"message\": \"Hello, everyone\",\n    \"likesCount\": 10\n  }],\n  profile: {\n    photos: {\n      small: '',\n      large: ''\n    }\n  },\n  status: '',\n  photos: {\n    small: '',\n    large: ''\n  }\n};\n\nvar profile_reducer = function profile_reducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case ADD_NEW_POST:\n      {\n        if (action.newPostText.length > 0) {\n          return _objectSpread({}, state, {\n            postsData: [].concat(_toConsumableArray(state.postsData), [{\n              \"id\": 5,\n              \"message\": action.newPostText,\n              \"likesCount\": 14\n            }]),\n            newPostText: ''\n          });\n        }\n\n        return state;\n      }\n\n    case PROFILE_INFO:\n      {\n        return _objectSpread({}, state, {\n          profile: action.profile\n        });\n      }\n\n    case SET_STATUS:\n      {\n        return _objectSpread({}, state, {\n          status: action.status\n        });\n      }\n\n    case SET_PHOTO:\n      {\n        return _objectSpread({}, state, {\n          profile: _objectSpread({}, state.profile, {\n            photos: action.photos\n          }),\n          photos: action.photoUrl\n        });\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n};\n\nexport var addPost = function addPost(newPostText) {\n  return {\n    type: ADD_NEW_POST,\n    newPostText: newPostText\n  };\n};\nexport var profileInfo = function profileInfo(profile) {\n  return {\n    type: PROFILE_INFO,\n    profile: profile\n  };\n};\nexport var setStatus = function setStatus(status) {\n  return {\n    type: SET_STATUS,\n    status: status\n  };\n};\nexport var setPhoto = function setPhoto(photoUrl) {\n  return {\n    type: SET_PHOTO,\n    photoUrl: photoUrl\n  };\n};\nexport var check_auth = function check_auth(userId) {\n  return function (dispatch) {\n    ProfileAPI.checkAuth(userId).then(function (data) {\n      dispatch(profileInfo(data));\n    });\n  };\n};\nexport var getStatus = function getStatus(userId) {\n  return function (dispatch) {\n    ProfileAPI.getStatus(userId).then(function (data) {\n      dispatch(setStatus(data));\n    });\n  };\n};\nexport var updateStatus = function updateStatus(status) {\n  return function (dispatch) {\n    ProfileAPI.updateStatus(status).then(function (data) {\n      if (data.resultCode === 0) {\n        dispatch(setStatus(status));\n      }\n    });\n  };\n};\nexport var updatePhoto = function updatePhoto(photo) {\n  return function (dispatch) {\n    ProfileAPI.updateMainPhoto(photo).then(function (data) {\n      if (data.resultCode === 0) {\n        dispatch(setPhoto(data.data.photos));\n      }\n    });\n  };\n};\nexport var saveProfile = function saveProfile(profile) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch, getState) {\n      var userId, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              userId = getState().auth.userId;\n              _context.next = 3;\n              return ProfileAPI.saveProfile(profile);\n\n            case 3:\n              response = _context.sent;\n              debugger;\n\n              if (!(response.resultCode === 0)) {\n                _context.next = 10;\n                break;\n              }\n\n              debugger;\n              dispatch(profileInfo(userId));\n              _context.next = 12;\n              break;\n\n            case 10:\n              dispatch(stopSubmit(\"editProfileData\", {\n                _error: response.data.messages[0]\n              }));\n              return _context.abrupt(\"return\", Promise.reject(response.data.messages[0]));\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport default profile_reducer;","map":{"version":3,"sources":["C:/Users/dikush/Documents/GitHub/react-my-way/src/redux/profile_reducer.js"],"names":["ProfileAPI","stopSubmit","ADD_NEW_POST","PROFILE_INFO","SET_STATUS","SET_PHOTO","initialState","postsData","profile","photos","small","large","status","profile_reducer","state","action","type","newPostText","length","photoUrl","addPost","profileInfo","setStatus","setPhoto","check_auth","userId","dispatch","checkAuth","then","data","getStatus","updateStatus","resultCode","updatePhoto","photo","updateMainPhoto","saveProfile","getState","auth","response","_error","messages","Promise","reject"],"mappings":"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","sourcesContent":["import {ProfileAPI} from \"../api/api\";\r\nimport { stopSubmit } from \"redux-form\";\r\n\r\nconst ADD_NEW_POST = \"ADD-NEW-POST\";\r\nconst PROFILE_INFO = \"PROFILE_INFO\";\r\nconst SET_STATUS = \"SET_STATUS\";\r\nconst SET_PHOTO = \"SET_PHOTO\";\r\n\r\nlet initialState = {\r\n    postsData: [\r\n        {\"id\": 1, \"message\": \"Hello, how are you?\", \"likesCount\": 5},\r\n        {\"id\": 2, \"message\": \"My, first post!\", \"likesCount\": 2},\r\n        {\"id\": 3, \"message\": \"Hello, everyone\", \"likesCount\": 10},\r\n    ],\r\n    profile: {\r\n        photos: {\r\n            small: '',\r\n            large: ''\r\n        }\r\n    },\r\n    status: '',\r\n    photos: {\r\n        small: '',\r\n        large: ''\r\n    }\r\n}\r\n\r\nlet profile_reducer = (state = initialState, action) => {\r\n\r\n    switch (action.type) {\r\n\r\n        case ADD_NEW_POST: {\r\n\r\n            if (action.newPostText.length > 0) {\r\n                return {\r\n                    ...state,\r\n                    postsData: [...state.postsData, {\r\n                        \"id\": 5,\r\n                        \"message\": action.newPostText,\r\n                        \"likesCount\": 14\r\n                    }],\r\n                    newPostText: ''\r\n                }\r\n            }\r\n\r\n            return state\r\n\r\n        }\r\n\r\n        case PROFILE_INFO: {\r\n\r\n            return {\r\n                ...state,\r\n                profile: action.profile\r\n            }\r\n        }\r\n\r\n        case SET_STATUS: {\r\n\r\n            return {\r\n                ...state,\r\n                status: action.status\r\n            }\r\n        }\r\n        case SET_PHOTO: {\r\n\r\n            return {\r\n                ...state,\r\n                profile: {...state.profile, photos: action.photos },\r\n                photos: action.photoUrl\r\n            }\r\n        }\r\n\r\n        default: {\r\n            return state\r\n        }\r\n    }\r\n}\r\n\r\nexport const addPost = (newPostText) => ({type: ADD_NEW_POST, newPostText});\r\nexport const profileInfo = (profile) => ({type: PROFILE_INFO, profile});\r\nexport const setStatus = (status) => ({type: SET_STATUS, status});\r\nexport const setPhoto = (photoUrl) => ({type: SET_PHOTO, photoUrl});\r\n\r\n\r\nexport const check_auth = (userId) => {\r\n    return (dispatch) => {\r\n        ProfileAPI.checkAuth(userId).then((data) => {\r\n            dispatch(profileInfo(data))\r\n        })\r\n    }\r\n}\r\n\r\nexport const getStatus = (userId) => (dispatch) => {\r\n    ProfileAPI.getStatus(userId).then((data) => {\r\n        dispatch(setStatus(data))\r\n    })\r\n}\r\n\r\nexport const updateStatus = (status) => (dispatch) => {\r\n    ProfileAPI.updateStatus(status).then((data) => {\r\n        if (data.resultCode === 0) {\r\n            dispatch(setStatus(status));\r\n        }\r\n    })\r\n}\r\n\r\nexport const updatePhoto = (photo) => (dispatch) => {\r\n    ProfileAPI.updateMainPhoto(photo).then((data) => {\r\n        if (data.resultCode === 0) {\r\n            dispatch(setPhoto(data.data.photos));\r\n        }\r\n    })\r\n}\r\n\r\nexport const saveProfile = (profile) => async (dispatch, getState) => {\r\n    const userId = getState().auth.userId;\r\n    const response = await ProfileAPI.saveProfile(profile);\r\n\r\n    debugger\r\n        if (response.resultCode === 0) {\r\n            debugger\r\n            dispatch(profileInfo(userId));\r\n        } else {\r\n            dispatch(stopSubmit(\"editProfileData\", {_error: response.data.messages[0]}));\r\n            return Promise.reject(response.data.messages[0]);\r\n        }\r\n}\r\n\r\n\r\nexport default profile_reducer"]},"metadata":{},"sourceType":"module"}