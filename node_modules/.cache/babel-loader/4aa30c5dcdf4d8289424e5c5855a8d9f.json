{"ast":null,"code":"import _objectWithoutProperties from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\dikush\\\\Documents\\\\GitHub\\\\react-my-way\\\\src\\\\components\\\\Profile\\\\ProfileInfo\\\\ProfilInfo.tsx\",\n    _this4 = this;\n\nimport React from 'react';\nimport s from './ProfileInfo.module.css';\nimport Preloader from '../../common/Preloader/Preloader';\nimport photoUser from \"../../../img/user.svg\";\nimport ProfileStatusWithHooks from \"./ProfileStatusWithHooks\";\nimport { ProfileDataFormRedux } from \"./ProfileDataForm\";\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css'; //     state = [editMode, setEditMode] = useState(false)\n// const [src, setSrc] = useState(null as string | ArrayBuffer | null)\n// const [cropImg, setCropImg] = useState({\n//       unit: '%',\n//       width: 30,\n//       aspect: 1 / 1\n//     })\n\nvar ProfileInfo = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(ProfileInfo, _React$PureComponent);\n\n  function ProfileInfo() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ProfileInfo);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProfileInfo)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      editMode: false,\n      src: null,\n      crop: {\n        unit: '%',\n        width: 30,\n        height: 30,\n        x: 0,\n        y: 0,\n        aspect: 1 / 1\n      },\n      croppedImageUrl: '',\n      isLoadImg: true\n    };\n\n    _this.onInputPhoto = function (e) {\n      if (e.target.files.length && e.target.files.length > 0) {\n        _this.setState({\n          isLoadImg: true\n        });\n\n        var reader = new FileReader();\n        reader.addEventListener('load', function () {\n          return _this.setState({\n            src: reader.result\n          });\n        });\n        reader.readAsDataURL(e.target.files[0]);\n      }\n    };\n\n    _this.onImageLoaded = function (image) {\n      _this.imageRef = image;\n    };\n\n    _this.onCropComplete = function (crop, percentCrop) {\n      _this.makeClientCrop(crop);\n    };\n\n    _this.onCropChange = function (crop, percentCrop) {\n      _this.setState({\n        crop: crop\n      });\n    };\n\n    _this.onSubmit = function (data) {\n      _this.props.saveProfile(data).then(function () {\n        _this.setState({\n          editMode: false\n        });\n      });\n    };\n\n    _this.updatePhotoCrop = function (url) {\n      var a = document.createElement('a');\n      a.href = url;\n      a.download = 'avatar.jpeg';\n\n      _this.setState({\n        isLoadImg: false\n      });\n\n      _this.props.updatePhoto(url);\n    };\n\n    return _this;\n  }\n\n  _createClass(ProfileInfo, [{\n    key: \"makeClientCrop\",\n    value: function () {\n      var _makeClientCrop = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(crop) {\n        var croppedImageUrl;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.imageRef && crop.width && crop.height)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                _context.next = 3;\n                return this.getCroppedImg(this.imageRef, crop, 'newFile.jpeg');\n\n              case 3:\n                croppedImageUrl = _context.sent;\n                this.setState({\n                  croppedImageUrl: croppedImageUrl\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function makeClientCrop(_x) {\n        return _makeClientCrop.apply(this, arguments);\n      }\n\n      return makeClientCrop;\n    }()\n  }, {\n    key: \"getCroppedImg\",\n    value: function getCroppedImg(image, crop, fileName) {\n      var _this2 = this;\n\n      var canvas = document.createElement('canvas');\n      var scaleX = image.naturalWidth / image.width;\n      var scaleY = image.naturalHeight / image.height;\n      canvas.width = crop.width;\n      canvas.height = crop.height;\n      var ctx = canvas.getContext('2d');\n      ctx && ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n      return new Promise(function (resolve, reject) {\n        canvas.toBlob(function (blob) {\n          if (!blob) {\n            console.error('Canvas is empty');\n            return;\n          } //@ts-ignore\n\n\n          blob.name = fileName;\n          window.URL.revokeObjectURL(_this2.fileUrl);\n          _this2.fileUrl = window.URL.createObjectURL(blob);\n          debugger;\n          resolve(_this2.fileUrl);\n        }, 'image/jpeg');\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          crop = _this$state.crop,\n          croppedImageUrl = _this$state.croppedImageUrl,\n          src = _this$state.src;\n\n      if (!this.props.profile) {\n        return /*#__PURE__*/React.createElement(Preloader, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 20\n          }\n        });\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: s.descriptionBlock,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          display: 'flex'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: this.props.profile.photos.large || photoUser,\n        alt: \"photo\",\n        className: s.avaImg,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginLeft: \"20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"b\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 28\n        }\n      }, this.props.profile.fullName || 'unknown user ')), /*#__PURE__*/React.createElement(ProfileStatusWithHooks, {\n        status: this.props.status,\n        updateStatus: this.props.updateStatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 25\n        }\n      })), this.props.isOwner && /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        onChange: this.onInputPhoto,\n        className: s.inputPhoto,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 44\n        }\n      })), src && this.state.isLoadImg && /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 48\n        }\n      }, /*#__PURE__*/React.createElement(ReactCrop, {\n        src: src,\n        crop: crop,\n        ruleOfThirds: true,\n        onImageLoaded: this.onImageLoaded,\n        onComplete: this.onCropComplete,\n        onChange: this.onCropChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this3.updatePhotoCrop(_this3.state.croppedImageUrl);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 17\n        }\n      }, \"Send\")), this.state.editMode //@ts-ignore\n      ?\n      /*#__PURE__*/\n      React.createElement(ProfileDataFormRedux, {\n        initialValues: props.profile,\n        profile: props.profile,\n        onSubmit: onSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 23\n        }\n      }) : /*#__PURE__*/React.createElement(ProfileData, {\n        profile: this.props.profile,\n        onEditMode: function onEditMode() {\n          return _this3.setState({\n            editMode: true\n          });\n        },\n        isOwner: this.props.isOwner,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 23\n        }\n      })));\n    }\n  }]);\n\n  return ProfileInfo;\n}(React.PureComponent);\n\nvar Contact = function Contact(_ref) {\n  var contactTitle = _ref.contactTitle,\n      contactValue = _ref.contactValue;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: s.contact,\n    style: {\n      display: 'flex'\n    },\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoKey,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 65\n    }\n  }, contactTitle, \":\"), \" \", contactValue);\n};\n\nvar ProfileData = function ProfileData(_ref2) {\n  var profile = _ref2.profile,\n      props = _objectWithoutProperties(_ref2, [\"profile\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'relative'\n    },\n    className: s.profileData,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 12\n    }\n  }, props.isOwner && /*#__PURE__*/React.createElement(\"button\", {\n    onClick: props.onEditMode,\n    className: s.editBtn + ' ' + s.btn,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 27\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoKey,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 39\n    }\n  }, \"Looking for a job: \"), /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoValue,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 93\n    }\n  }, profile.lookingForAJob ? 'yes' : 'no')), profile.lookingForAJob && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: 'flex'\n    },\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 36\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoKey,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 66\n    }\n  }, \"My work skills: \"), /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoValue,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 117\n    }\n  }, profile.lookingForAJob && profile.lookingForAJobDescription)), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: s.infoKey,\n    __self: _this4,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 13\n    }\n  }, \"Contacts\"), \":\", profile.contacts && Object.keys(profile.contacts).map(function (key) {\n    return profile.contacts[key] && /*#__PURE__*/React.createElement(Contact, {\n      key: key,\n      className: s.infoValue,\n      contactTitle: key,\n      contactValue: profile.contacts[key],\n      __self: _this4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 71\n      }\n    });\n  })));\n};\n\nexport default ProfileInfo;","map":{"version":3,"sources":["C:/Users/dikush/Documents/GitHub/react-my-way/src/components/Profile/ProfileInfo/ProfilInfo.tsx"],"names":["React","s","Preloader","ProfileStatusWithHooks","ProfileDataFormRedux","ReactCrop","ProfileInfo","state","editMode","src","crop","unit","width","height","x","y","aspect","croppedImageUrl","isLoadImg","onInputPhoto","e","target","files","length","setState","reader","FileReader","addEventListener","result","readAsDataURL","onImageLoaded","image","imageRef","onCropComplete","percentCrop","makeClientCrop","onCropChange","onSubmit","data","props","saveProfile","then","updatePhotoCrop","url","a","document","createElement","href","download","updatePhoto","getCroppedImg","fileName","canvas","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","drawImage","Promise","resolve","reject","toBlob","blob","console","error","name","window","URL","revokeObjectURL","fileUrl","createObjectURL","profile","descriptionBlock","display","photos","large","photoUser","avaImg","marginLeft","fullName","status","updateStatus","isOwner","inputPhoto","PureComponent","Contact","contactTitle","contactValue","contact","infoKey","ProfileData","position","profileData","onEditMode","editBtn","btn","infoValue","lookingForAJob","lookingForAJobDescription","contacts","Object","keys","map","key"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport  s from './ProfileInfo.module.css'\r\nimport Preloader from '../../common/Preloader/Preloader';\r\nimport photoUser from '../../../img/user.svg'\r\nimport ProfileStatusWithHooks from \"./ProfileStatusWithHooks\";\r\nimport {ProfileDataFormRedux} from \"./ProfileDataForm\"\r\nimport { ProfileType, SaveProfileType, ContactsType } from '../../../Types/Types';\r\nimport ReactCrop from 'react-image-crop';\r\nimport 'react-image-crop/dist/ReactCrop.css';\r\n\r\n//     state = [editMode, setEditMode] = useState(false)\r\n// const [src, setSrc] = useState(null as string | ArrayBuffer | null)\r\n// const [cropImg, setCropImg] = useState({\r\n//       unit: '%',\r\n//       width: 30,\r\n//       aspect: 1 / 1\r\n//     })\r\n\r\nclass ProfileInfo extends React.PureComponent<PropsType> {\r\n\r\n    state = {\r\n        editMode: false,\r\n        src: null as string | null,\r\n        crop : {\r\n          unit: '%' as \"%\" | \"px\" | undefined,\r\n          width: 30,\r\n          height: 30,\r\n          x: 0,\r\n          y: 0,\r\n          aspect: 1 / 1\r\n        },\r\n        croppedImageUrl: '' as string,\r\n        isLoadImg: true\r\n    }\r\n\r\n    onInputPhoto = (e: any) => {\r\n        if(e.target.files.length && e.target.files.length > 0){\r\n            this.setState({isLoadImg: true})\r\n            const reader = new FileReader();\r\n            reader.addEventListener('load', () =>\r\n                this.setState( { src: reader.result } )\r\n            );\r\n            reader.readAsDataURL(e.target.files[0]);\r\n        }\r\n    }\r\n\r\n    onImageLoaded = (image: HTMLImageElement) => {\r\n        this.imageRef = image;\r\n      };\r\n    \r\n      onCropComplete = (crop: ReactCrop.Crop , percentCrop: ReactCrop.PercentCrop) => {\r\n        this.makeClientCrop(crop);\r\n      };\r\n    \r\n      onCropChange = (crop: ReactCrop.Crop, percentCrop: ReactCrop.PercentCrop) => {\r\n        this.setState({ crop });\r\n      };\r\n    imageRef: any;\r\n    \r\n      async makeClientCrop(crop: ReactCrop.Crop) {\r\n        if (this.imageRef && crop.width && crop.height) {\r\n          const croppedImageUrl = await this.getCroppedImg(\r\n            this.imageRef,\r\n            crop,\r\n            'newFile.jpeg'\r\n          );\r\n          this.setState({ croppedImageUrl: croppedImageUrl });\r\n        }\r\n      }\r\n    \r\n      getCroppedImg(image: HTMLImageElement, crop: ReactCrop.Crop, fileName: string) {\r\n        const canvas = document.createElement('canvas');\r\n        const scaleX = image.naturalWidth / image.width;\r\n        const scaleY = image.naturalHeight / image.height;\r\n        canvas.width = crop.width;\r\n        canvas.height = crop.height;\r\n        const ctx = canvas.getContext('2d');\r\n    \r\n        ctx && ctx.drawImage(\r\n          image,\r\n          crop.x * scaleX,\r\n          crop.y * scaleY,\r\n          crop.width * scaleX,\r\n          crop.height * scaleY,\r\n          0,\r\n          0,\r\n          crop.width,\r\n          crop.height\r\n        );\r\n    \r\n        return new Promise((resolve, reject) => {\r\n          canvas.toBlob(blob => {\r\n            if (!blob) {\r\n              console.error('Canvas is empty');\r\n              return;\r\n            }\r\n            //@ts-ignore\r\n            blob.name = fileName;\r\n            window.URL.revokeObjectURL(this.fileUrl);\r\n            this.fileUrl = window.URL.createObjectURL(blob);\r\n            debugger\r\n            resolve(this.fileUrl);\r\n          }, 'image/jpeg');\r\n        });\r\n      }\r\n    fileUrl: any\r\n    \r\n    onSubmit = (data: SaveProfileType) => {\r\n        this.props.saveProfile(data).then(() => {\r\n            this.setState({editMode: false})\r\n        });\r\n    }\r\n\r\n    updatePhotoCrop = (url: string) => {\r\n        var a = document.createElement('a')\r\n        a.href = url\r\n        a.download = 'avatar.jpeg'\r\n        this.setState({isLoadImg: false})\r\n        this.props.updatePhoto(url)\r\n    }\r\n        \r\n    render(){\r\n        const { crop, croppedImageUrl, src } = this.state;\r\n\r\n        if (!this.props.profile){\r\n            return <Preloader />\r\n        }\r\n\r\n        return (<div>\r\n            <div className={s.descriptionBlock}>\r\n                <div style={{display:'flex'}}>\r\n                    <img src={ this.props.profile.photos.large || photoUser } alt=\"photo\" className={s.avaImg}/>\r\n                    <div style={{marginLeft:\"20px\"}}>\r\n                        <p><b>{this.props.profile.fullName || 'unknown user '}</b></p>\r\n                        <ProfileStatusWithHooks status = {this.props.status} updateStatus = {this.props.updateStatus}/>\r\n                    </div>\r\n                    {this.props.isOwner && <input type=\"file\" onChange={this.onInputPhoto} className={s.inputPhoto}/>}\r\n                </div>\r\n\r\n                { \r\n                src && this.state.isLoadImg && <div>\r\n                    <ReactCrop\r\n                        src={src}\r\n                        crop={crop}\r\n                        ruleOfThirds\r\n                        onImageLoaded={this.onImageLoaded}\r\n                        onComplete={this.onCropComplete}\r\n                        onChange={this.onCropChange}\r\n                />\r\n                <button onClick = {() => this.updatePhotoCrop(this.state.croppedImageUrl)}>Send</button>\r\n                </div>\r\n                }\r\n\r\n                {\r\n                this.state.editMode \r\n                //@ts-ignore\r\n                    ? <ProfileDataFormRedux initialValues = {props.profile} profile = {props.profile} onSubmit = {onSubmit}/>\r\n                    : <ProfileData profile = {this.props.profile} onEditMode = {() => this.setState({editMode: true})} isOwner={this.props.isOwner}/>\r\n                }\r\n            </div>\r\n        </div>);\r\n    }\r\n}\r\n\r\nconst Contact: React.FC<ContactType> = ({contactTitle, contactValue}) => {\r\n    return <div className={s.contact}  style={{display:'flex'}}><span className={s.infoKey}>{contactTitle}:</span> {contactValue}</div>\r\n}\r\n\r\nconst ProfileData: React.FC<ProfileDataType> = ({profile, ...props}) => {\r\n\r\n    return <div style={{position: 'relative'}} className={s.profileData}>\r\n        {props.isOwner && <button onClick = {props.onEditMode} className = {s.editBtn + ' ' + s.btn}/>}\r\n        {/* <div style={{display:'flex'}}><span className={s.infoKey}>About me: </span><span className={s.infoValue}>{profile.aboutMe}</span></div> */}\r\n        <div style={{display:'flex'}}><span className={s.infoKey}>Looking for a job: </span><span className={s.infoValue}>{profile.lookingForAJob ? 'yes' : 'no'}</span></div>\r\n        {profile.lookingForAJob && <div style={{display:'flex'}}><span className={s.infoKey}>My work skills: </span><span className={s.infoValue}>{profile.lookingForAJob && profile.lookingForAJobDescription}</span></div>}\r\n        <div>\r\n            <span className={s.infoKey}>Contacts</span>: \r\n            {\r\n            profile.contacts && Object\r\n                .keys(profile.contacts)\r\n                .map(key => {\r\n                return profile.contacts[key as keyof ContactsType] && <Contact key={key} className={s.infoValue} contactTitle={key} contactValue={profile.contacts[key as keyof ContactsType]} />\r\n            })\r\n            }\r\n        </div>\r\n    </div>\r\n}\r\n\r\ntype ContactType = {\r\n    contactTitle: string\r\n    contactValue: string\r\n    className: string\r\n}\r\n\r\n\r\ntype ProfileDataType = {\r\n    profile: ProfileType\r\n    isOwner: boolean\r\n    onEditMode: () => void\r\n}\r\n\r\ntype PropsType = {\r\n    profile: ProfileType | null\r\n    isOwner: boolean\r\n    status: string\r\n\r\n    updatePhoto: (url: string) => void\r\n    saveProfile: (data: SaveProfileType) => Promise<SaveProfileType>\r\n    updateStatus: (data: string) => void\r\n}\r\n\r\nexport default ProfileInfo;"]},"metadata":{},"sourceType":"module"}